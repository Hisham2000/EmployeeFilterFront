<p-table #dt1 [value]="users" styleClass="p-datatable-gridlines p-datatable-striped"
         [tableStyle]="{ 'min-width': '60rem' }"
         [paginator]="true"
         [rows]="5"
         [showCurrentPageReport]="true"
         currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
         [rowsPerPageOptions]="[10, 25, 50]"

>
  <ng-template pTemplate="caption">
    <div class="flex align-items-center justify-content-between">
      Employees

      <button pButton label="Clear" class="p-button-outlined" icon="pi pi-filter-slash" (click)="clear(dt1)"></button>
      <p-button icon="pi pi-refresh" (click)="ngOnInit()"></p-button>

    </div>
  </ng-template>
  <ng-template pTemplate="header">
    <tr>
      <th>
        <div class="flex align-items-center">
          Edit
        </div>
      </th>
      <th pSortableColumn="code" style="width:20%">
        <div class="flex align-items-center">
          EmployeeCode
          <p-sortIcon field="code"></p-sortIcon>
          <p-columnFilter type="text" field="code" display="menu"></p-columnFilter>
        </div>
      </th>
      <th pSortableColumn="name" style="width:20%">
        <div class="flex align-items-center">
          EmployeeName
          <p-sortIcon field="name"></p-sortIcon>
          <p-columnFilter type="text" field="name" display="menu"></p-columnFilter>
        </div>
      </th>
      <th pSortableColumn="birthDate" style="width:20%">
        <div class="flex align-items-center">
          BirthDate
          <p-sortIcon field="birthDate"></p-sortIcon>
          <p-columnFilter type="date" field="birthDate" display="menu"></p-columnFilter>
        </div>
      </th>
      <th pSortableColumn="birthCity" style="width:20%">
        <div class="flex align-items-center">
          BirthCity
          <p-sortIcon field="birthCity"></p-sortIcon>
          <p-columnFilter type="text" field="birthCity" display="menu"></p-columnFilter>
        </div>
      </th>
      <th pSortableColumn="id" style="width:20%">
        <div class="flex align-items-center">
          EmployeeID
          <p-sortIcon field="id"></p-sortIcon>
        </div>
      </th>
      <th pSortableColumn="department.name" style="width:20%">
        <div class="flex align-items-center">
          Department
          <p-sortIcon field="department.name"></p-sortIcon>
          <p-columnFilter field="department" matchMode="in" display="menu" [showMatchModes]="false"
                          [showOperator]="false" [showAddButton]="false">
            <ng-template pTemplate="header">
              <div class="px-3 pt-3 pb-0">
                <span class="font-bold">Department Picker</span>
              </div>
            </ng-template>
            <ng-template pTemplate="filter" let-value let-filter="filterCallback">
              <p-multiSelect [ngModel]="value" [options]="departments" placeholder="Select"
                             (onChange)="filter($event.value)" optionLabel="name">
                <ng-template let-departement pTemplate="item">
                  <div class="inline-block vertical-align-middle">
                    <span class="ml-1 mt-1">{{ departement.name }}</span>
                  </div>
                </ng-template>
              </p-multiSelect>
            </ng-template>
          </p-columnFilter>
        </div>
      </th>
      <th pSortableColumn="jobTitle" style="width:20%">
        <div class="flex align-items-center">
          JobTitle
          <p-sortIcon field="jobTitle"></p-sortIcon>
          <p-columnFilter type="text" field="jobTitle" display="menu"></p-columnFilter>
        </div>
      </th>
      <th>
        <div class="flex align-items-center">
          DirectManager
          <p-columnFilter field="directManager" matchMode="in" display="menu" [showMatchModes]="false"
                          [showOperator]="false" [showAddButton]="false">
            <ng-template pTemplate="header">
              <div class="px-3 pt-3 pb-0">
                <span class="font-bold">directManager Picker</span>
              </div>
            </ng-template>
            <ng-template pTemplate="filter" let-value let-filter="filterCallback">
              <p-multiSelect [ngModel]="value" [options]="managers" placeholder="Select"
                             (onChange)="filter($event.value)" optionLabel="name">
                <ng-template let-manager pTemplate="item">
                  <div class="inline-block vertical-align-middle">
                    <span class="ml-1 mt-1">{{ manager.name }}</span>
                  </div>
                </ng-template>
              </p-multiSelect>
            </ng-template>
          </p-columnFilter>
        </div>
      </th>
      <th pSortableColumn="contractsTypes.name" style="width:20%">
        <div class="flex align-items-center">
          ContractType
<!--          <p-sortIcon field="contractsTypes.name"></p-sortIcon>-->
          <p-columnFilter field="contractsTypes" matchMode="in" display="menu" [showMatchModes]="false"
                          [showOperator]="false" [showAddButton]="false">
            <ng-template pTemplate="header">
              <div class="px-3 pt-3 pb-0">
                <span class="font-bold">ContractType Picker</span>
              </div>
            </ng-template>
            <ng-template pTemplate="filter" let-value let-filter="filterCallback">
              <p-multiSelect [ngModel]="value" [options]="contractTypes" placeholder="Select"
                             (onChange)="filter($event.value)" optionLabel="name">
                <ng-template let-contractType pTemplate="item">
                  <div class="inline-block vertical-align-middle">
                    <span class="ml-1 mt-1">{{ contractType.name }}</span>
                  </div>
                </ng-template>
              </p-multiSelect>
            </ng-template>
          </p-columnFilter>
        </div>
      </th>
      <th>Status</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-user>
    <tr>
      <td style="cursor: pointer" (click)="openEdit(user)"><span><i class="pi pi-pencil"></i></span></td>
      <td>{{ user.code }}</td>
      <td>{{ user.name }}</td>
      <td>{{ user.birthDate | date }}</td>
      <td>{{ user.birthCity }}</td>
      <td>{{ user.id }}</td>
      <td>{{ user.department.name }}</td>
      <td>{{ user.jobTitle }}</td>
      <td>{{ (user.directManager) ? user.directManager.name : "" }}</td>
      <td>{{ user.contractsTypes.name }}</td>
      <td *ngIf="user.status"><span><i class="pi pi-check fw-bold" style="color: greenyellow"></i></span> </td>
      <td *ngIf="!user.status"><span><i class="pi pi-times fw-bold" style="color: red"></i></span> </td>
    </tr>
  </ng-template>
  <ng-template pTemplate="paginatorleft">
    <p-button type="button" icon="pi pi-plus" styleClass="p-button-text"
              (click)="_router.navigate(['/employee/add'])"></p-button>
  </ng-template>
  <ng-template pTemplate="paginatorright">
  </ng-template>
  <ng-template pTemplate="summary">
    <div class="flex align-items-center justify-content-between">
      In total there are {{users ? users.length : 0 }} Employes.
    </div>
  </ng-template>
</p-table>



<p-dialog
  header="Edit Employee"
  [(visible)]="isEdit"
  [style]="{width: '50vw'}"
  [breakpoints]="{ '960px': '75vw' }"
  [modal]="true"
  [draggable]="false"
  [resizable]="false"
  [maximizable]="true"
>
  <ng-template pTemplate="header">
    <span class="text-xl font-bold">Edit Employee</span>
  </ng-template>
  <ng-template pTemplate="body">
    <p>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
      consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
    </p>
  </ng-template>
</p-dialog>
